# ğŸš€ ClassificaÃ§Ã£o de TrÃ¡fego de Rede (Treinamento + ValidaÃ§Ã£o)

Este projeto implementa um **pipeline completo de Machine Learning** para detectar ataques de rede em datasets de trÃ¡fego.  
O cÃ³digo estÃ¡ dividido em duas etapas principais:

1. **Treinamento (`train.py`)** â†’ Treina modelos, gera mÃ©tricas e salva artefatos.  
2. **ValidaÃ§Ã£o (`evaluate.py`)** â†’ Usa os modelos jÃ¡ treinados para avaliar dados novos (holdout ou produÃ§Ã£o).

---

## ğŸ“‚ Estrutura do Projeto



---

## âš™ï¸ Fluxo do Pipeline

### ğŸ”¹ 1. Treinamento (`treinamento_modelo.py`)
- LÃª datasets de trÃ¡fego:  
  - `Friday-WorkingHours-Afternoon-DDos.pcap_ISCX.csv`  
  - `Friday-WorkingHours-Afternoon-PortScan.pcap_ISCX.csv`  
  - `Wednesday-workingHours.pcap_ISCX.csv`  
- Faz **prÃ©-processamento**:  
  - Remove colunas irrelevantes (`Flow ID`, `Source IP`, `Destination IP`, `Timestamp`).  
  - Converte `Label` para binÃ¡rio (**0 = BENIGN**, **1 = ataque**).  
  - Balanceia benignos e ataques via **downsampling**.  
  - Trata valores invÃ¡lidos (`NaN`, `inf`) substituindo por `0`.  
- Separa treino/teste (70%/30%, estratificado).  
- Seleciona **20 features mais relevantes** usando `SelectKBest (f_classif)`.  
- Treina dois modelos:  
  - `RandomForestClassifier`  
  - `ExtraTreesClassifier`  
- Avalia com mÃ©tricas:  
  - `accuracy`, `precision`, `recall`, `f1`, `ROC AUC`, `PR AUC`.  
- Gera e salva:  
  - Modelos `.joblib`  
  - Seletor `.joblib`  
  - Lista de features `.json`  
  - MÃ©tricas `registry.json`  
  - Curva ROC `roc_comparacao.png`  

---

### ğŸ”¹ 2. ValidaÃ§Ã£o (`rede.py`)
- LÃª os artefatos salvos (`registry.json`, modelos `.joblib`, `selector.joblib`).  
- Carrega um dataset de teste (ex.: `Trafego/normal.csv`).  
- Aplica o **mesmo prÃ©-processamento do treino**.  
- Gera prediÃ§Ãµes e scores para cada modelo.  
- Se o dataset tiver coluna `Label`, calcula:  
  - classification report (precision, recall, f1, accuracy)  
  - matriz de confusÃ£o  
  - curva ROC comparativa  
- Salva resultados em:  
  - `avaliacao_holdout_metricas.csv`  
  - `avaliacao_holdout_predicoes.csv`  

---

## ğŸ“¦ DependÃªncias

As bibliotecas necessÃ¡rias estÃ£o listadas em `requirements.txt`:

## â–¶ï¸ Como Executar

### 1. Criar ambiente virtual (opcional, mas recomendado)
```bash
python -m venv venv
venv\Scripts\activate   # Windows
source venv/bin/activate # Linux/Mac

pip install -r requirements.txt

Realizar o download do dataset de treinamento do modelo em http://cicresearch.ca/CICDataset/CIC-IDS-2017/Dataset/

ApÃ³s baixar o dataset armazene em uma pasta dentro de treinamento 

â”œâ”€â”€ treinamento/ # Artefatos de treino (modelos, selector, registry, etc.)
â”‚ â”œâ”€â”€ Trafego/
â”‚ â”‚ â”œâ”€â”€ Friday-WorkingHours-Afternoon-DDos.pcap_ISCX.csv
â”‚ â”‚ â”œâ”€â”€ Friday-WorkingHours-Afternoon-PortScan.pcap_ISCX.csv
â”‚ â”‚ â”œâ”€â”€ Wednesday-workingHours.pcap_ISCX.csv

 # Exemplos de arquivos CSV de trÃ¡fego

python treinamento_modelo.py

### Edite essa variÃ¡vel com as runs que deseja no arquivo rede.py
RUN_DIR = "runs/run_20250901_235809"

python rede.py