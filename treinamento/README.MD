# üöÄ Classifica√ß√£o de Tr√°fego de Rede (Treinamento + Valida√ß√£o)

Este projeto implementa um **pipeline completo de Machine Learning** para detectar ataques de rede em datasets de tr√°fego.  
O c√≥digo est√° dividido em duas etapas principais:

1. **Treinamento (`train.py`)** ‚Üí Treina modelos, gera m√©tricas e salva artefatos.  
2. **Valida√ß√£o (`evaluate.py`)** ‚Üí Usa os modelos j√° treinados para avaliar dados novos (holdout ou produ√ß√£o).

---

## üìÇ Estrutura do Projeto



---

## ‚öôÔ∏è Fluxo do Pipeline

### üîπ 1. Treinamento (`treinamento_modelo.py`)
- L√™ datasets de tr√°fego:  
  - `Friday-WorkingHours-Afternoon-DDos.pcap_ISCX.csv`  
  - `Friday-WorkingHours-Afternoon-PortScan.pcap_ISCX.csv`  
  - `Wednesday-workingHours.pcap_ISCX.csv`  
- Faz **pr√©-processamento**:  
  - Remove colunas irrelevantes (`Flow ID`, `Source IP`, `Destination IP`, `Timestamp`).  
  - Converte `Label` para bin√°rio (**0 = BENIGN**, **1 = ataque**).  
  - Balanceia benignos e ataques via **downsampling**.  
  - Trata valores inv√°lidos (`NaN`, `inf`) substituindo por `0`.  
- Separa treino/teste (70%/30%, estratificado).  
- Seleciona **20 features mais relevantes** usando `SelectKBest (f_classif)`.  
- Treina dois modelos:  
  - `RandomForestClassifier`  
  - `ExtraTreesClassifier`  
- Avalia com m√©tricas:  
  - `accuracy`, `precision`, `recall`, `f1`, `ROC AUC`, `PR AUC`.  
- Gera e salva:  
  - Modelos `.joblib`  
  - Seletor `.joblib`  
  - Lista de features `.json`  
  - M√©tricas `registry.json`  
  - Curva ROC `roc_comparacao.png`  

---

### üîπ 2. Valida√ß√£o (`rede.py`)
- L√™ os artefatos salvos (`registry.json`, modelos `.joblib`, `selector.joblib`).  
- Carrega um dataset de teste (ex.: `Trafego/normal.csv`).  
- Aplica o **mesmo pr√©-processamento do treino**.  
- Gera predi√ß√µes e scores para cada modelo.  
- Se o dataset tiver coluna `Label`, calcula:  
  - classification report (precision, recall, f1, accuracy)  
  - matriz de confus√£o  
  - curva ROC comparativa  
- Salva resultados em:  
  - `avaliacao_holdout_metricas.csv`  
  - `avaliacao_holdout_predicoes.csv`  

---

## üì¶ Depend√™ncias

As bibliotecas necess√°rias est√£o listadas em `requirements.txt`:

## ‚ñ∂Ô∏è Como Executar

### 1. Criar ambiente virtual (opcional, mas recomendado)
```bash
python -m venv venv
venv\Scripts\activate   # Windows
source venv/bin/activate # Linux/Mac

pip install -r requirements.txt

python treinamento_modelo.py

### Edite essa vari√°vel com as runs que deseja
RUN_DIR = "runs/run_20250901_235809"

python rede.py